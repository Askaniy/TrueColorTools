import numpy as np


# CIE RGB colour matching function: Stiles & Burch 1959 10 Degree RGB CMFs
# https://colour.readthedocs.io/en/v0.3.15/generated/colour.RGB_CMFS.html?highlight=dataset.cmfs


rgb_nm = list(range(390, 831, 5)) # np.arange breaks the function polator()
rgb = np.array([
    [3.346603970102795e-05, -2.0587412568294118e-05, 0.0005668672223374708],
    [8.47806339092708e-05, -5.1468531420735294e-05, 0.0014720261741344],
    [0.00019856516889276584, -0.00012867132855183823, 0.003657207886048199],
    [0.00041944103091955034, -0.0003036643353823382, 0.008283575861899171],
    [0.0007808742596906522, -0.00061247552390675, 0.016475721526647138],
    [0.0011846978054163894, -0.0010345174815567793, 0.0282336448802921],
    [0.001566210658008108, -0.0014874405580592499, 0.04269790206961273],
    [0.001702305886125622, -0.0017396363620208527, 0.0562478572874213],
    [0.0016621466384843882, -0.0017962517465836617, 0.06983438458409036],
    [0.0012516298848184453, -0.001420531467212294, 0.08025742705932773],
    [0.0007206353882288019, -0.0008698181810104263, 0.08919015732100045],
    [-9.816704978968199e-05, 0.0001235244754097647, 0.09160391452579227],
    [-0.0010664511318060907, 0.0014565594392068086, 0.0913936250723445],
    [-0.0021641372339998074, 0.0032733985983587647, 0.08355805717648623],
    [-0.003538475931055355, 0.005568895099723558, 0.07585963457635476],
    [-0.004986439915453164, 0.008322461530732897, 0.06781377722704873],
    [-0.006354085404568507, 0.011328223765703837, 0.056083282932549126],
    [-0.007465157922642635, 0.014390601385237588, 0.04315505305536875],
    [-0.008424517727405436, 0.01764341257102806, 0.03195485390434614],
    [-0.009227702680230107, 0.02103004193851244, 0.02344270254956896],
    [-0.009631526225955844, 0.024272559418018765, 0.016631152861804187],
    [-0.009932720583265095, 0.028261370603125748, 0.011949926767662492],
    [-0.009705151513298106, 0.032219300669380294, 0.008320147940759652],
    [-0.009236626957483713, 0.036527216749295835, 0.005302951434769889],
    [-0.008194717588125044, 0.04084027968235345, 0.0032640580382980178],
    [-0.006347392196628301, 0.04485482513317081, 0.0018286039430240996],
    [-0.004138633576360457, 0.04877672722743084, 0.0008685868729364473],
    [-0.0009705151513298105, 0.05118545449792125, 6.400113800584349e-05],
    [0.0028334580280203665, 0.052513342608576215, -0.0003931498477501814],
    [0.0069810158816344305, 0.05339860134901287, -0.0005851532617677119],
    [0.011962993658460791, 0.05412945449518731, -0.0007497276166398809],
    [0.017228317238089187, 0.05347580414614396, -0.0008594438532213268],
    [0.022442326223509345, 0.051617790161855415, -0.0008868729123666883],
    [0.02835689097333768, 0.04991418177182908, -0.0008868729123666883],
    [0.03474667348692062, 0.047155468487677675, -0.0008503008335062062],
    [0.04119669487196541, 0.044113678280712214, -0.0007954427152154832],
    [0.04799253200058748, 0.04026383213044122, -0.0007314415772096399],
    [0.05410343084999518, 0.03578606989683725, -0.0006674404392037963],
    [0.05928843593434112, 0.030706125845610676, -0.0005760102420525914],
    [0.06503790155497771, 0.026058517458318275, -0.0004909801587019707],
    [0.06867008239719595, 0.021632223756135043, -0.00040686437732286214],
    [0.07053079420457312, 0.01729342655736706, -0.00032640580382980176],
    [0.07066465836337722, 0.013335496491112514, -0.0002532616461088378],
    [0.06927024004250106, 0.009866517473354956, -0.00019017481007450635],
    [0.0657317641114457, 0.007035748245214513, -0.00013714529572680747],
    [0.06067169890865027, 0.00482774824726497, -9.417310306574113e-05],
    [0.054719205980494096, 0.0031447272698069263, -6.217253406281939e-05],
    [0.04841420410082043, 0.0019094825157092794, -4.04121471408326e-05],
    [0.04095797045543141, 0.0011065734255458087, -2.4869013625127755e-05],
    [0.033865401108126886, 0.0005764475519122352, -1.2891657798319903e-05],
    [0.027727729426958354, 0.0002264615382512353, -5.019517823601154e-06],
    [0.022466867985956762, 4.014545450817353e-06, -2.0114643373265097e-07],
    [0.017462579515996383, -7.040895098356588e-05, 2.166895672483558e-06],
    [0.013239165305726658, -0.00010231944046442177, 2.6149036385244625e-06],
    [0.009910409890131077, -0.0001115837761201541, 2.38632814564645e-06],
    [0.007324600555898317, -0.00010324587402999499, 2.057179435902112e-06],
    [0.005341179936284061, -8.451132859284735e-05, 1.6640295881519304e-06],
    [0.0038419013576780083, -6.546797196717529e-05, 1.2708797404017492e-06],
    [0.0027241356316636753, -4.874069925543632e-05, 9.417310306574112e-07],
    [0.0019031021243317895, -3.5153006960362205e-05, 6.747548549758927e-07],
    [0.0013074066176534918, -2.460195801911147e-05, 4.7726562912929e-07],
    [0.0009102762798679603, -1.7344895088787793e-05, 3.3554882354492226e-07],
    [0.0006336236850061292, -1.2095104883872793e-05, 2.3406130470708475e-07],
    [0.000439520654740167, -8.389370621579852e-06, 1.6091714698612077e-07],
    [0.00030119435730925154, -5.713006987701617e-06, 1.0971623658144596e-07],
    [0.00020615080455833217, -3.849846150271e-06, 7.469847107253446e-08],
    [0.0001423422221950389, -2.614601396173353e-06, 5.074375941891876e-08],
    [9.839015672102217e-05, -1.770517480873294e-06, 3.4286323931701865e-08],
    [6.84938279214372e-05, -1.2043636352452058e-06, 2.3223270076406067e-08],
    [4.774488330679988e-05, -8.183496495896912e-07, 1.5634563712856053e-08],
    [3.324293276968776e-05, -5.507132862018675e-07, 1.0605902869539778e-08],
    [2.3426227790719564e-05, -3.721174821719162e-07, 7.17727047636959e-09],
    [1.6487602226039768e-05, -2.5065174801898087e-07, 4.854943468728984e-09],
    [1.1668492509091746e-05, -1.693314683742191e-07, 3.291487097443379e-09],
    [8.29957784585493e-06, -1.1426013975403234e-07, 2.2308968104894013e-09],
    [5.912333680514938e-06, -7.720279713110294e-08, 1.508598252994882e-09],
    [4.23903169546354e-06, -5.249790204914999e-08, 1.0240182080934958e-09],
    [3.034254266226534e-06, -3.541034961746588e-08, 6.884693845485735e-10],
    [2.195372204387434e-06, -2.393286711064191e-08, 4.6355109955660923e-10],
    [1.5907524204555285e-06, -1.605818180326941e-08, 3.108626703140969e-10],
    [1.1556939043421652e-06, -1.0705454535512941e-08, 2.075465475332353e-10],
    [8.411131311525025e-07, -7.051188804640734e-09, 1.3714529572680746e-10],
    [6.157751304989143e-07, -4.5292307650247055e-09, 9.01501743910881e-11],
    [4.529070706205782e-07, -2.8462097875666616e-09, 5.842389597961998e-11],
    [3.3242932769687763e-07, -1.729342655736706e-09, 3.7212090240540424e-11],
    [2.45417624474205e-07, -1.0087832158464118e-09, 2.313183987925486e-11],
    [1.825014698362724e-07, -5.610069924860147e-10, 1.3897389966983156e-11],
    [1.3587212118617348e-07, -2.9337062909819116e-10, 7.89956903386411e-12],
    [1.0151365375978477e-07, -1.4256783203543677e-10, 4.04121471408326e-12]
], dtype="float32")

xyz_nm = list(range(360, 831, 5))
xyz = np.array([
    [1.222e-07, 1.3398e-08, 5.35027e-07],
    [9.1927e-07, 1.0065e-07, 4.0283e-06],
    [5.9586e-06, 6.511e-07, 2.61437e-05],
    [3.3266e-05, 3.625e-06, 0.00014622],
    [0.000159952, 1.7364e-05, 0.000704776],
    [0.00066244, 7.156e-05, 0.0029278],
    [0.0023616, 0.0002534, 0.0104822],
    [0.0072423, 0.0007685, 0.032344],
    [0.0191097, 0.0020044, 0.0860109],
    [0.0434, 0.004509, 0.19712],
    [0.084736, 0.008756, 0.389366],
    [0.140638, 0.014456, 0.65676],
    [0.204492, 0.021391, 0.972542],
    [0.264737, 0.029497, 1.2825],
    [0.314679, 0.038676, 1.55348],
    [0.357719, 0.049602, 1.7985],
    [0.383734, 0.062077, 1.96728],
    [0.386726, 0.074704, 2.0273],
    [0.370702, 0.089456, 1.9948],
    [0.342957, 0.106256, 1.9007],
    [0.302273, 0.128201, 1.74537],
    [0.254085, 0.152761, 1.5549],
    [0.195618, 0.18519, 1.31756],
    [0.132349, 0.21994, 1.0302],
    [0.080507, 0.253589, 0.772125],
    [0.041072, 0.297665, 0.5706],
    [0.016172, 0.339133, 0.415254],
    [0.005132, 0.395379, 0.302356],
    [0.003816, 0.460777, 0.218502],
    [0.015444, 0.53136, 0.159249],
    [0.037465, 0.606741, 0.112044],
    [0.071358, 0.68566, 0.082248],
    [0.117749, 0.761757, 0.060709],
    [0.172953, 0.82333, 0.04305],
    [0.236491, 0.875211, 0.030451],
    [0.304213, 0.92381, 0.020584],
    [0.376772, 0.961988, 0.013676],
    [0.451584, 0.9822, 0.007918],
    [0.529826, 0.991761, 0.003988],
    [0.616053, 0.99911, 0.001091],
    [0.705224, 0.99734, 0.0],
    [0.793832, 0.98238, 0.0],
    [0.878655, 0.955552, 0.0],
    [0.951162, 0.915175, 0.0],
    [1.01416, 0.868934, 0.0],
    [1.0743, 0.825623, 0.0],
    [1.11852, 0.777405, 0.0],
    [1.1343, 0.720353, 0.0],
    [1.12399, 0.658341, 0.0],
    [1.0891, 0.593878, 0.0],
    [1.03048, 0.527963, 0.0],
    [0.95074, 0.461834, 0.0],
    [0.856297, 0.398057, 0.0],
    [0.75493, 0.339554, 0.0],
    [0.647467, 0.283493, 0.0],
    [0.53511, 0.228254, 0.0],
    [0.431567, 0.179828, 0.0],
    [0.34369, 0.140211, 0.0],
    [0.268329, 0.107633, 0.0],
    [0.2043, 0.081187, 0.0],
    [0.152568, 0.060281, 0.0],
    [0.11221, 0.044096, 0.0],
    [0.0812606, 0.0318004, 0.0],
    [0.05793, 0.0226017, 0.0],
    [0.0408508, 0.0159051, 0.0],
    [0.028623, 0.0111303, 0.0],
    [0.0199413, 0.0077488, 0.0],
    [0.013842, 0.0053751, 0.0],
    [0.00957688, 0.00371774, 0.0],
    [0.0066052, 0.00256456, 0.0],
    [0.00455263, 0.00176847, 0.0],
    [0.0031447, 0.00122239, 0.0],
    [0.00217496, 0.00084619, 0.0],
    [0.0015057, 0.00058644, 0.0],
    [0.00104476, 0.00040741, 0.0],
    [0.00072745, 0.000284041, 0.0],
    [0.000508258, 0.00019873, 0.0],
    [0.00035638, 0.00013955, 0.0],
    [0.000250969, 9.8428e-05, 0.0],
    [0.00017773, 6.9819e-05, 0.0],
    [0.00012639, 4.9737e-05, 0.0],
    [9.0151e-05, 3.55405e-05, 0.0],
    [6.45258e-05, 2.5486e-05, 0.0],
    [4.6339e-05, 1.83384e-05, 0.0],
    [3.34117e-05, 1.3249e-05, 0.0],
    [2.4209e-05, 9.6196e-06, 0.0],
    [1.76115e-05, 7.0128e-06, 0.0],
    [1.2855e-05, 5.1298e-06, 0.0],
    [9.41363e-06, 3.76473e-06, 0.0],
    [6.913e-06, 2.77081e-06, 0.0],
    [5.09347e-06, 2.04613e-06, 0.0],
    [3.7671e-06, 1.51677e-06, 0.0],
    [2.79531e-06, 1.12809e-06, 0.0],
    [2.082e-06, 8.4216e-07, 0.0],
    [1.55314e-06, 6.297e-07, 0.0]
], dtype="float32")